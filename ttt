<!-- Split button –¥–ª—è —Ç–µ–≥–æ–≤ -->
<div id="qfb-tags-splitbutton" class="qfb-splitbutton">
  <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å –∫–Ω–æ–ø–∫–∏: —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –≤—Å–µ–º —Ç–µ–≥–∞–º -->
  <button id="qfb-tags-main" class="qfb-filterbutton-left">
    üè∑ –í—Å–µ –º–µ—Ç–∫–∏
  </button>

  <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å –∫–Ω–æ–ø–∫–∏: –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç popup -->
  <button id="qfb-tags-dropdown" class="qfb-filterbutton-right">
    ‚ñæ
  </button>

  <!-- Popup –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ–≥–æ–≤ -->
  <menupopup id="qfb-tags-popup" hidden="true">
    <menuitem label="–í–∞–∂–Ω–æ–µ" data-tag="$label1"/>
    <menuitem label="–†–∞–±–æ—á–µ–µ" data-tag="$label2"/>
    <menuitem label="–õ–∏—á–Ω–æ–µ" data-tag="$label3"/>
    <menuitem label="–ö –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é" data-tag="$label4"/>
    <menuitem label="–û—Ç–ª–æ–∂–µ–Ω–æ" data-tag="$label5"/>
    <menuseparator/>
    <menuitem label="–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë" data-action="reset"/>
  </menupopup>
</div>

.qfb-splitbutton {
  display: inline-flex;
  border: 1px solid #ccc;
  border-radius: 4px;
  overflow: hidden;
}

.qfb-splitbutton button {
  border: none;
  background: #f9f9f9;
  padding: 4px 8px;
  cursor: pointer;
}

.qfb-filterbutton-left {
  flex: 1;
}

.qfb-filterbutton-right {
  width: 24px;
  text-align: center;
  border-left: 1px solid #ccc;
  background: #eaeaea;
}


let mainButton = document.getElementById("qfb-tags-main");
let dropdownButton = document.getElementById("qfb-tags-dropdown");
let tagsPopup = document.getElementById("qfb-tags-popup");

// –õ–µ–≤–∞—è —á–∞—Å—Ç—å: —Ñ–∏–ª—å—Ç—Ä –ø–æ –≤—Å–µ–º —Ç–µ–≥–∞–º
mainButton.addEventListener("click", () => {
  console.log("–§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –≤—Å–µ–º –º–µ—Ç–∫–∞–º");
  // –¢—É—Ç –≤—ã–∑—ã–≤–∞–µ—à—å —Ñ—É–Ω–∫—Ü–∏—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö —Ç–µ–≥–æ–≤
});

// –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: –æ—Ç–∫—Ä—ã—Ç–∏–µ popup
dropdownButton.addEventListener("click", () => {
  if (tagsPopup.state === "open") {
    tagsPopup.hidePopup();
  } else {
    tagsPopup.openPopup(dropdownButton, "after_start", 0, 0, false, false);
  }
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ç–µ–≥–∞ –∏–ª–∏ —Å–±—Ä–æ—Å–∞
tagsPopup.addEventListener("command", event => {
  let target = event.target;
  if (target.dataset.tag) {
    console.log("–í—ã–±—Ä–∞–Ω —Ç–µ–≥:", target.dataset.tag);
    // –ó–¥–µ—Å—å —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ç–µ–≥—É
  } else if (target.dataset.action === "reset") {
    console.log("–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë");
    // –ó–¥–µ—Å—å —Å–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤
  }
  tagsPopup.hidePopup();
});
