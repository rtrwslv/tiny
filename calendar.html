init() {
  const mailContext = document.getElementById("mailContext")
  if (mailContext) {
    mailContext.addEventListener("keydown", (event) => {
      const key = event.code.replace(/^Key/, "").toLowerCase()
      const activePopup = document.querySelector("menupopup[_moz-menuactive='true'][open='true']")
      if (!activePopup) return
      const item = activePopup.querySelector(`menuitem[accesskey="${key}"], menu[accesskey="${key}"]`)
      if (!item) return
      event.preventDefault()
      event.stopImmediatePropagation()
      if (item.tagName === "MENU") {
        const submenu = item.querySelector("menupopup")
        if (submenu) submenu.openPopup(item, "after_start", 0, 0, false, false)
        return
      }
      if (typeof MailContext?.onMenuItemCommand === "function") {
        MailContext.onMenuItemCommand(item.id)
      } else {
        item.click()
      }
    }, true)
  }
}
